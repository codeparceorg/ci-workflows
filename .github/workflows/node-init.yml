# .github/workflows/node-build.yml
permissions:
  contents: read

on:
  workflow_call:
    inputs:
      node-version:
        required: true
        type: string
    secrets:
      TERRAFORM_REPO_TOKEN:
        required: true
      ARM_CLIENT_ID:
        required: true
      ARM_CLIENT_SECRET:
        required: true
      ARM_TENANT_ID:
        required: true
      ARM_SUBSCRIPTION_ID:
        required: true

jobs:
  build:
    uses: ./.github/workflows/node-build.yml
    with:
      node-version: ${{ inputs.node-version }}

  azure-terraform:
    name: Azure
    uses: ./.github/workflows/azure-arquitecture.yml
    secrets: inherit

  azure-deploy:
    name: Azure
    uses: ./.github/workflows/azure-web-app.yml
    needs: [azure-terraform, build]
